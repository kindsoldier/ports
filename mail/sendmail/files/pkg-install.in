#!/bin/sh

set -x

SENDMAIL_GROUP="%%SENDMAIL_GROUP%%"
SENDMAIL_OWNER="%%SENDMAIL_OWNER%%"
SENDMAIL_GROUPID="%%SENDMAIL_GROUPID%%"
SENDMAIL_OWNERID="%%SENDMAIL_OWNERID%%"
SENDMAIL_SPOOLDIR="%%SENDMAIL_SPOOLDIR%%"
SENDMAIL_CSPOOLDIR="%%SENDMAIL_CSPOOLDIR%%"
SENDMAIL_SYSCONFDIR="%%SENDMAIL_SYSCONFDIR%%"

case $2 in 
    PRE-INSTALL)
	pw group add ${SENDMAIL_GROUP} -g ${SENDMAIL_GROUPID}
	pw user add ${SENDMAIL_OWNER} -g ${SENDMAIL_GROUP}  \
	    -d ${SENDMAIL_SPOOLDIR} -s /usr/sbin/nologin -u ${SENDMAIL_OWNERID} \
	    -c "sendmail"
	pw group mod ${SENDMAIL_GROUP} -M ${SENDMAIL_OWNER}
	pw group show ${SENDMAIL_GROUP}
	pw user show ${SENDMAIL_OWNER}
	;;
    POST-INSTALL)
	install -d -o ${SENDMAIL_OWNER} -g ${SENDMAIL_OWNER} -m 0700 ${SENDMAIL_SPOOLDIR}
	install -d -o ${SENDMAIL_OWNER} -g ${SENDMAIL_OWNER} -m 0750 ${SENDMAIL_CSPOOLDIR}
	install -d -o root -g ${SENDMAIL_OWNER} -m 0755 ${SENDMAIL_SYSCONFDIR}

	chmod 2555 ${PKG_PREFIX}/sbin/sendmail
	chown root:${SENDMAIL_OWNER} ${PKG_PREFIX}/sbin/sendmail
	;;
esac
exit 0
#EOF
