#!/bin/sh -x

GROUP="%%GROUP%%"
OWNER="%%OWNER%%"
GROUP_ID="%%GROUP_ID%%"
OWNER_ID="%%OWNER_ID%%"
RUNDIR="%%RUNDIR%%"
DATADIR="%%DATADIR%%"
LOGDIR="%%LOGDIR%%"
DBDIR="%%DBDIR%%"


PKG_PREFIX="/notexist"

case $2 in 
    PRE-INSTALL)
	pw group add ${GROUP}  -g ${GROUP_ID}

	pw user add ${OWNER} -g ${GROUP}  \
	    -d "/var/empty" -s "/usr/sbin/nologin" -u ${OWNER_ID} \
	    -c "asterisk"

	pw group mod ${GROUP} -M ${OWNER}
	pw group show ${GROUP}
	pw user show ${OWNER}

	for dir in ${RUNDIR} ${DBDIR} ${DATADIR} ${DBDIR}; do
	    install -o ${OWNER} -g ${GROUP} -m 0750 -d ${dir}
	done

	for dir in dictate meetme monitor outgoing system tmp voicemail; do
	    install -o ${OWNER} -g ${GROUP} -m 0750 -d ${DATADIR}/${dir}
	done

	for dir in cdr-csv cdr-custom cel-custom; do
	    install -o ${OWNER} -g ${GROUP} -m 0750 -d ${LOGDIR}/${dir}
	done
	;;
    POST-INSTALL)
	;;
esac
exit 0
#EOF
