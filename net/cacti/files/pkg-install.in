#!/bin/sh

set -x

CACTI_GROUP="%%CACTI_GROUP%%"
CACTI_OWNER="%%CACTI_OWNER%%"
CACTI_GROUP_ID="%%CACTI_GROUP_ID%%"
CACTI_OWNER_ID="%%CACTI_OWNER_ID%%"
CACTI_DBDIR="%%CACTI_DBDIR%%"
CACTI_LOGDIR="%%CACTI_LOGDIR%%"

WWWDIR="%%WWWDIR%%"

PKG_PREFIX="/notexist"

case $2 in 
    PRE-INSTALL)
	pw group add ${CACTI_GROUP}  -g ${CACTI_GROUP_ID}

	pw user add ${CACTI_OWNER} -g ${CACTI_GROUP}  \
	    -d ${PKG_PREFIX} -s /usr/sbin/nologin -u ${CACTI_OWNER_ID} \
	    -c "cacti"

	pw group mod ${CACTI_GROUP} -M ${CACTI_OWNER}
	pw group show ${CACTI_GROUP}
	pw user show ${CACTI_OWNER}

	for dir in ${CACTI_DBDIR}/rra ${CACTI_DBDIR}/scripts ${CACTI_LOGDIR}; do
	    install -d -m 0755 -o ${CACTI_OWNER} -g ${CACTI_GROUP} ${dir}
	done
	install -d -o www -g www -m 0755 ${WWWDIR}/resource/snmp_queries/ 
	install -d -o www -g www -m 0755 ${WWWDIR}/resource/script_server/ 
	install -d -o www -g www -m 0755 ${WWWDIR}/resource/script_queries/ 
	install -d -o www -g www -m 0755 ${WWWDIR}/scripts/
	install -d -o www -g www -m 0755 ${WWWDIR}/log/
	install -d -o www -g www -m 0755 ${WWWDIR}/cache/boost/
	install -d -o www -g www -m 0755 ${WWWDIR}/cache/mibcache/
	install -d -o www -g www -m 0755 ${WWWDIR}/cache/realtime/
	install -d -o www -g www -m 0755 ${WWWDIR}/cache/spikekill/
	;;
    POST-INSTALL)
	;;
esac
#EOF
