#!/bin/sh

set -x

GITEA_LOGDIR="%%GITEA_LOGDIR%%"
GITEA_DBDIR="%%GITEA_DBDIR%%"
GITEA_RUNDIR="%%GITEA_RUNDIR%%"

GROUP="%%GITEA_GROUP%%"
OWNER="%%GITEA_OWNER%%"

GROUP_ID="%%GITEA_GROUP_ID%%"
OWNER_ID="%%GITEA_OWNER_ID%%"

PKG_PREFIX="/notexist"

case $2 in 
    PRE-INSTALL)
	pw group add ${GROUP} -g ${GROUP_ID}
	pw user add ${OWNER} -u ${OWNER_ID} -g ${GROUP} \
	  -d ${PKG_PREFIX} -s "/usr/sbin/nologin" -c "gitea"
	pw group mod ${GROUP} -M ${OWNER}
	pw group show ${GROUP} 
	pw user show ${OWNER}

	install -d -o ${OWNER} -g ${GROUP} -m 0750 ${GITEA_DBDIR}
	install -d -o ${OWNER} -g ${GROUP} -m 0750 ${GITEA_LOGDIR}
	install -d -o ${OWNER} -g ${GROUP} -m 0750 ${GITEA_RUNDIR}
	;;
    POST-INSTALL)
	;;
esac
#EOF
