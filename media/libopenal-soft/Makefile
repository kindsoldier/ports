# $FreeBSD: head/audio/openal-soft/Makefile 542069 2020-07-12 09:30:28Z tobik $

PORTNAME=	openal-soft
PORTVERSION=	1.20.1
CATEGORIES=	audio
MASTER_SITES=	https://openal-soft.org/openal-releases/
PKGNAMEPREFIX=  lib

MAINTAINER=	tobik@FreeBSD.org
COMMENT=	Software implementation of the OpenAL specification

#LIB_DEPENDS=	libmysofa.so:audio/libmysofa

USES=		cmake compiler:c++11-lang tar:bzip2 gmake
USE_LDCONFIG=	yes

CMAKE_ARGS=	-DCMAKE_INSTALL_DATADIR:STRING="${PREFIX}/etc"

CMAKE_OFF+=	ALSOFT_BACKEND_ALSA
CMAKE_OFF+=     ALSOFT_DLOPEN
CMAKE_OFF+=     ALSOFT_EXAMPLES
CMAKE_OFF+=     ALSOFT_REQUIRE_QSA
CMAKE_OFF+=     ALSOFT_REQUIRE_SOLARIS
CMAKE_ON+=	ALSOFT_BACKEND_WAVE ALSOFT_UTILS

# do not link with librt and libdl.
LDFLAGS+=	-Wl,--as-needed
LDFLAGS_i386=	-Wl,-z,notext

CONFIG_DESC=	Install configuration utility (needs Qt 5)

CMAKE_OFF+=	ALSOFT_NO_CONFIG_UTIL
#CONFIG_CMAKE_ON=	-DALSOFT_NO_QT5:BOOL=OFF

CMAKE_OFF+=     ALSOFT_BACKEND_JACK 
CMAKE_OFF+=     ALSOFT_REQUIRE_JACK

CMAKE_ON+=      ALSOFT_BACKEND_OSS 
CMAKE_ON+=      ALSOFT_REQUIRE_OSS

CMAKE_OFF+=     ALSOFT_BACKEND_PORTAUDIO 
CMAKE_OFF+=     ALSOFT_REQUIRE_PORTAUDIO

CMAKE_OFF+=     ALSOFT_BACKEND_PULSEAUDIO 
CMAKE_OFF+=     ALSOFT_REQUIRE_PULSEAUDIO

CMAKE_OFF+=     ALSOFT_BACKEND_SDL2 
CMAKE_OFF+=     ALSOFT_REQUIRE_SDL2

CMAKE_OFF+=     ALSOFT_BACKEND_SNDIO 
CMAKE_OFF+=     ALSOFT_REQUIRE_SNDIO

post-patch:
	${REINPLACE_CMD} 's|/etc/openal|${ETCDIR}|' \
		${WRKSRC}/alc/alconfig.cpp

.include <bsd.port.mk>
